x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
Epoch 1/30
2018-03-09 01:32:09.815086: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
 - 217s - loss: 0.5304 - acc: 0.8296 - val_loss: 0.0437 - val_acc: 0.9857
Epoch 2/30
 - 217s - loss: 0.1568 - acc: 0.9533 - val_loss: 0.0280 - val_acc: 0.9898
Epoch 3/30
 - 217s - loss: 0.1078 - acc: 0.9677 - val_loss: 0.0280 - val_acc: 0.9911
Epoch 4/30
 - 216s - loss: 0.0930 - acc: 0.9734 - val_loss: 0.0200 - val_acc: 0.9929
Epoch 5/30
 - 220s - loss: 0.0870 - acc: 0.9757 - val_loss: 0.0217 - val_acc: 0.9929
Epoch 6/30
 - 215s - loss: 0.0788 - acc: 0.9777 - val_loss: 0.0239 - val_acc: 0.9924
Epoch 7/30
 - 216s - loss: 0.0736 - acc: 0.9795 - val_loss: 0.0451 - val_acc: 0.9880
Epoch 8/30
 - 215s - loss: 0.0727 - acc: 0.9796 - val_loss: 0.0291 - val_acc: 0.9926

Epoch 00008: ReduceLROnPlateau reducing learning rate to 0.000500000023749.
Epoch 9/30
 - 215s - loss: 0.0556 - acc: 0.9849 - val_loss: 0.0166 - val_acc: 0.9948
Epoch 10/30
 - 215s - loss: 0.0511 - acc: 0.9857 - val_loss: 0.0196 - val_acc: 0.9935
Epoch 11/30
 - 214s - loss: 0.0544 - acc: 0.9851 - val_loss: 0.0178 - val_acc: 0.9945
Epoch 12/30
 - 215s - loss: 0.0501 - acc: 0.9858 - val_loss: 0.0217 - val_acc: 0.9939
Epoch 13/30
 - 215s - loss: 0.0515 - acc: 0.9862 - val_loss: 0.0242 - val_acc: 0.9933

Epoch 00013: ReduceLROnPlateau reducing learning rate to 0.000250000011874.
Epoch 14/30
 - 217s - loss: 0.0445 - acc: 0.9878 - val_loss: 0.0180 - val_acc: 0.9947
Epoch 15/30
 - 216s - loss: 0.0437 - acc: 0.9882 - val_loss: 0.0193 - val_acc: 0.9941
Epoch 16/30
 - 215s - loss: 0.0427 - acc: 0.9888 - val_loss: 0.0183 - val_acc: 0.9946

Epoch 00016: ReduceLROnPlateau reducing learning rate to 0.000125000005937.
Epoch 17/30
 - 215s - loss: 0.0413 - acc: 0.9892 - val_loss: 0.0162 - val_acc: 0.9953
Epoch 18/30
 - 215s - loss: 0.0378 - acc: 0.9895 - val_loss: 0.0210 - val_acc: 0.9941
Epoch 19/30
 - 215s - loss: 0.0391 - acc: 0.9894 - val_loss: 0.0179 - val_acc: 0.9954
Epoch 20/30
 - 214s - loss: 0.0406 - acc: 0.9892 - val_loss: 0.0185 - val_acc: 0.9951
Epoch 21/30
 - 215s - loss: 0.0383 - acc: 0.9897 - val_loss: 0.0176 - val_acc: 0.9951

Epoch 00021: ReduceLROnPlateau reducing learning rate to 6.25000029686e-05.
Epoch 22/30
 - 224s - loss: 0.0371 - acc: 0.9903 - val_loss: 0.0189 - val_acc: 0.9946
Epoch 23/30
 - 214s - loss: 0.0356 - acc: 0.9902 - val_loss: 0.0185 - val_acc: 0.9948
Epoch 24/30
 - 215s - loss: 0.0352 - acc: 0.9905 - val_loss: 0.0173 - val_acc: 0.9956
Epoch 25/30
 - 214s - loss: 0.0352 - acc: 0.9902 - val_loss: 0.0168 - val_acc: 0.9954
Epoch 26/30
 - 214s - loss: 0.0359 - acc: 0.9904 - val_loss: 0.0170 - val_acc: 0.9951
Epoch 27/30
 - 214s - loss: 0.0374 - acc: 0.9898 - val_loss: 0.0171 - val_acc: 0.9950
Epoch 28/30
 - 214s - loss: 0.0374 - acc: 0.9897 - val_loss: 0.0191 - val_acc: 0.9946

Epoch 00028: ReduceLROnPlateau reducing learning rate to 3.12500014843e-05.
Epoch 29/30
 - 214s - loss: 0.0327 - acc: 0.9910 - val_loss: 0.0161 - val_acc: 0.9958
Epoch 30/30
 - 215s - loss: 0.0324 - acc: 0.9905 - val_loss: 0.0168 - val_acc: 0.9955
Test loss: 0.0168177612746
Test accuracy: 0.9955
CNN Error: 0.45%
Saved json file
Saved weights of model
